p=lambda n,e=range:(s:=e(21),l:=min(i for i in e(2,10)if all((a-b)*a*b<1for a,b in zip(n[0],n[0][i:]))),o:={(a%l,b%l):v for a in s for b in s if(v:=n[a][b])})and[[o[i%l,j%l]for j in s]for i in s]