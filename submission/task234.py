f=lambda g,V:(t:=[g[0]]*g.count(V))*(s:=[y for x in g for y in x if y][0]in V)+[v for v in g if v!=V]+t*-~-s
p=lambda g:[[*zip(*f(Z:=[*zip(*g)],V:=[v for v in g+Z if~-len(v)==v.count(0)][0]))],f(g,V)][V in g]