p=lambda g,k=26,l=1:-k*(g:=[*zip(*g[::-1])])or p([(b:=0)or[(a>0)*[[[b|(b:=a|c),l:=l*2][(a|((a>0)&k//26))&1],a.bit_count()][k<2],a==max(sum(g,()))or(a>0)*2][k<1]for a,c in zip(x,y)]for x,y in zip(g,[(0,)*10]+g)],k-1)