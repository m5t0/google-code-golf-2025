p=lambda g,k=3:-k*g or p([(t:=0)or[t:=(x+6*(t>0))%~16*6%38%5for x in v]for v in zip(*g[::-1])],k-1)