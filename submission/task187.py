p=lambda g,k=66:g*~k or p([[(a or 2,a or(b==3)*3)[k>1]for a,b in zip(x,(3,)+x)]for x in zip(*g[::-1])],k-1)