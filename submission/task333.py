p=lambda g,k=3:-k*g or p([[v[j]or(3in v[:j])*max(v[j:])for j in range(10)]for v in zip(*g[::-1])],k-1)