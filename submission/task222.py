p=lambda g,k=5:-k*g or p([[w*(w in v[j-1::2]!=4<sum(g,[]).count(w))for j,w in enumerate(v)]for v in zip(*g)],k-1)