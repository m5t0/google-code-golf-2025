p=lambda g,t=0:[[(t:=[x+2*(0<x<t<9),3+5*x//8+t//3*9][8in{*w}&{*v}])%9for*w,x in zip(*g,v)]for v in g]