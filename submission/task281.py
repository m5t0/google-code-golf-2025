p=lambda g,k=3,c=0,d=1:-k*g or p([*zip(*[[c:=c+(len({*v})==2),d:=d-(8in v),[v,*filter(any,g)][c>1and('8'in str(g))*2*d+(8in v)]][2]for v in g])][::-1],k-1)