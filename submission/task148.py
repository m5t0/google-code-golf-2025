p=lambda g,e=enumerate:[[x&2or x/2or((8in v)&(2in v[j:])^(8in v[j:])|(8in g[i-abs((r:=[*zip(*g)])[0].index(2)-r[-1].index(2))]))*8for j,x in e(v)]for i,v in e(g)]