p=lambda g,c=list.count:[[x*(c(v,x)>=(s:=c(sum(g,[]),x))/len(g))*(c(w,x)>=s/len(g[0]))for*w,x in zip(*g,v)]for v in g]