def p(g,e=enumerate):*l,=zip(*g);f=lambda m=l,h=min:h(i for i,v in e(m)if 1in v);a,b=f(g),f(g,max);x,y=f(),f(l,max);return[[v[j]or(a<=i<=b)*(x<=j<=y)*(sum(v[x+1:y])+sum(w[a+1:b])+(i in(a,b))+(j in(x,y))>1)*2for j,w in e(l)]for i,v in e(g)]