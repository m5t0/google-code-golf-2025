def p(m):f=range(n:=len(m));a,i=[u for u in f if len({*m[u]})<2][:2];d=i-a;r=f[d:n-d:d];_,x,i=max((sum(m[u+(a//3-1)*d][t+(a%3-1)*d]>0for a in f[:9]),u,t)for u in r for t in r);return[[m[u][t]or next((m[x-r][i-q]for a in f[:9]if-1<u+(r:=(a//3-1)*d)<n>t+(q:=(a%3-1)*d)>-1and m[u+r][t+q]==m[x][i]),0)for t in f]for u in f]