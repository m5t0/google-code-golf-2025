def p(t):e=range(m:=len(t));g,a=[n for n in e if len({*t[n]})<2][:2];r=a-g;u=e[r:m-r:r];g,u,i=max((sum(t[n+(g//3-1)*r][a+(g%3-1)*r]>0for g in e[:9]),n,a)for n in u for a in u);return[[t[n][a]or next((t[u-f][i-d]for g in e[:9]if-1<n+(f:=(g//3-1)*r)<m>a+(d:=(g%3-1)*r)>-1and t[n+f][a+d]==t[u][i]),0)for a in e]for n in e]