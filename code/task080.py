def p(i):x=range(a:=len(i));u,r=[p for p in x if len({*i[p]})<2][:2];l=r-u;d=x[l:a-l:l];f,e,r=max((sum(i[p+(u//3-1)*l][n+(u%3-1)*l]>0for u in x[:9]),p,n)for p in d for n in d);return[[i[p][n]or next((i[e-d][r-h]for u in x[:9]if-1<p+(d:=(u//3-1)*l)<a>n+(h:=(u%3-1)*l)>-1and i[p+d][n+h]==i[e][r]),0)for n in x]for p in x]