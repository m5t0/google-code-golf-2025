def p(g):r=range(f:=len(g));a,l=[n for n in r if len({*g[n]})<2][:2];d=l-a;x=r[d:f-d:d];h,x,u=max((sum(g[n+(a//3-1)*d][l+(a%3-1)*d]>0for a in r[:9]),n,l)for n in x for l in x);return[[g[n][l]or next((g[x-i][u-e]for a in r[:9]if-1<n+(i:=(a//3-1)*d)<f>l+(e:=(a%3-1)*d)>-1and g[n+i][l+e]==g[x][u]),0)for l in r]for n in r]