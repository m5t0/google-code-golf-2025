def p(g):r=range(f:=len(g));a,m=[n for n in r if len({*g[n]})<2][:2];d=m-a;x=r[d:f-d:d];_,x,u=max((sum(g[n+(a//3-1)*d][t+(a%3-1)*d]>0for a in r[:9]),n,t)for n in x for t in x);return[[g[n][t]or next((g[x-p][u-e]for a in r[:9]if-1<n+(p:=(a//3-1)*d)<f>t+(e:=(a%3-1)*d)>-1and g[n+p][t+e]==g[x][u]),0)for t in r]for n in r]