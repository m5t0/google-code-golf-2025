p=lambda g,r=range(20):[[w[i]or(c:=max((sum(x in v for v in g)==4)*x for x in r))in w!=i>=(h:=20-w[::-1].index(c))and max(w[h:])for w in zip(*g)]for i in r]