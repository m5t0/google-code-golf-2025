p=lambda g,t=0:[g:=[t&(t:=t^(v.count(5)>2))and~(s:=v.index(5)>5)and[[x,8][s&(s:=s^(x==5))]for x in v]or v for v in zip(*g)][::-1]for _ in[0]*4][3]