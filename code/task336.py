p=lambda i,r=range(10):[[(l:=[[s[b]or(5in{*[*zip(*i)][b]}&{*s})*8for b in r]for s in i])[f][b]or sum(8in(x:=n[e::s])and x.index(8)<x.index(5)for s in[-1,1]for n,e in[(l[f],b),([*[*zip(*l)][b]],f)])*8for b in r]for f in r]