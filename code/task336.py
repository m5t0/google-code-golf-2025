p=lambda i,l=range(10):[[(i:=[[n[p]or(5in{*[*zip(*i)][p]}&{*n})*8for p in l]for n in i])[a][p]or sum(8in(m:=b[z::n])and m.index(8)<m.index(5)for n in[-1,1]for b,z in[(i[a],p),([*[*zip(*i)][p]],a)])*8for p in l]for a in l]