p=lambda g,r=range(10):[[(l:=[[a[b]or(5in{*[*zip(*g)][b]}&{*a})*8for b in r]for a in g])[i][b]or sum(8in(s:=n[e::y])and s.index(8)<s.index(5)for y in[-1,1]for n,e in[(l[i],b),([*[*zip(*l)][b]],i)])*8for b in r]for i in r]