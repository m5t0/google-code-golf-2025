p=lambda g,r=range(10):[[(o:=[[m[s]or(5in{*[*zip(*g)][s]}&{*m})*8for s in r]for m in g])[i][s]or sum(8in(n:=l[e::d])and n.index(8)<n.index(5)for d in[-1,1]for l,e in[(o[i],s),([*[*zip(*o)][s]],i)])*8for s in r]for i in r]