p=lambda g,k=7,s=0:-k*g or p([[(c:=0)or[[w,(0<(c:=c+(w>0))<sum(map(bool,v))>3)*2][w<1]for w in v],[x or any(w)*2for*w,x in zip(*zip(*g[::-1]),v)]][s<(s:=s|any(v))]for v in zip(*g[::-1])],k-1)