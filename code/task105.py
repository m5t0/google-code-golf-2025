def p(e,s=enumerate):*t,=zip(*e);f=lambda r=t,n=min:n(i for i,r in s(r)if any(r));n=lambda f,r:sum(e or j in f for j,e in s(r))>3;a=f(e),f(e,max);f=f(),f(t,max);return[[r[j]or a[0]<=i<=a[1]and f[0]<=j<=f[1]and(n(f,r)|n(a,e)|(i in a)|(j in f))*2for j,e in s(t)]for i,r in s(e)]