def p(a,y=enumerate):*r,=zip(*a);o=lambda m=r,n=min:n(a for a,m in y(m)if any(m));n=lambda a,m:sum(r or o in a for o,r in y(m))>3;e=o(a),o(a,max);f=o(),o(r,max);return[[m[o]or e[0]<=a<=e[1]and f[0]<=o<=f[1]and(n(f,m)|n(e,r)|(a in e)|(o in f))*2for o,r in y(r)]for a,m in y(a)]