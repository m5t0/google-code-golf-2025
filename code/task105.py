def p(i,y=enumerate):*n,=zip(*i);f=lambda m=n,o=min:o(i for i,m in y(m)if any(m));o=lambda i,m:sum(n or f in i for f,n in y(m))>3;a=f(i),f(i,max);e=f(),f(n,max);return[[m[f]or a[0]<=i<=a[1]and e[0]<=f<=e[1]and(o(e,m)|o(a,n)|(i in a)|(f in e))*2for f,n in y(n)]for i,m in y(i)]