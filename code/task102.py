p=lambda g,k=55,l=1:-k*g or p([(b:=0)or[[(a>0)*[b|(b:=a),l:=l*2][a&1],2*(a.bit_count()in[1,4,9,16])+(a<1)*5,a^5][(k<1)+k//55*2]for a in r]for r in zip(*g[::-1])],k-1)