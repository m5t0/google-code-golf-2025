def p(g, r=range):a=[x for v in g for x in v if x];b=[x for x in a if a.count(x)==1][0];return[[[g[k][l]for k in r(len(g))for l in r(len(g[0]))if g[k][l]!=0 and(abs(i-k)%(m:=len(set(a)))+abs(j-l)%m)<1][0]if(any(x==b for x in g[i])|any(row[j]==b for row in g))else g[i][j]for j in r(len(g[0]))]for i in r(len(g))]