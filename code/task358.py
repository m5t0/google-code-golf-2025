p=lambda g,e=enumerate:[[((b:=min(a:=[x for r in g for x in r if x],key=a.count))in r or b in[*zip(*g)][j])and[t for k,s in e(g)for l,t in e(s)if(k-i)%(m:=len({*a}))+(l-j)%m<1<=t][0]or x for j,x in e(r)]for i,r in e(g)]