p=lambda g,k=3,s=0:-k*g or p([[x*(x>1)for x in v]for v in zip(*g[::-1])if(s:=s|max(v))>1],k-1)