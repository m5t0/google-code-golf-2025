def p(s):o,m,n=range,len(s),len(s[0]);s=[s,[*zip(*s)]][m<n];a,i=[f for f in o(len(s))if sum(s[f])];p=2*(a-i);return[[((k:=[f,r][m<n])>=min(a,i))*((k%p==a%p)*sum(s[a])+(k%p==i%p)*sum(s[i]))for r in o(n)]for f in o(m)]