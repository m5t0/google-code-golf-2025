def p(f):n=range(len(f));*e,=zip(*f);[exec("f[u][k:l+1]=f[j][k:l+1]=[3]*(l+1-k)\nfor u in n[u:j]:f[u][k]=f[u][l]=3"*all(f[u][k:l]+f[j][k:l]+[*e[k]][u:j]+[*e[l]][u:j]))for u in n for j in n[u+2:]for k in n for l in n[k+2:]];return f