def p(f):q=range(len(f));*n,=zip(*f);[exec("f[e][p:l+1]=f[x][p:l+1]=[3]*(l+1-p)\nfor x in q[e:x]:f[x][p]=f[x][l]=3"*all(f[e][p:l]+f[x][p:l]+[*n[p]][e:x]+[*n[l]][e:x]))for e in q for x in q[e+2:]for p in q for l in q[p+2:]];return f