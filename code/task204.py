p=lambda g:[(t:=0)or[(t:=[2+v[j:].index(1)%2*5if t==1 else(1<t<8)*t,1+(t>0)*8][x>0])%8for j,x in enumerate(v)]for v in g]