def p(z,p=enumerate):z=[[max(a[d],a[~d],n[~e],z[~d][~e])for e,a in p(zip(*z))]for d,n in p(z)];return[[a[d]or sum(e&1and(19-d>e>d)*n[d-17]+(19-d<e<d)*n[d-2]for d,e,n in((d,e,n),(e,d,a)))for e,a in p(zip(*z))]for d,n in p(z)]