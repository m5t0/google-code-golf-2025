def p(z,e=enumerate):z=[[max(d[r],d[~r],m[~e],z[~r][~e])for e,d in e(zip(*z))]for r,m in e(z)];return[[d[r]or sum(m&1and(19-e>m>e)*r[e-17]+(19-e<m<e)*r[e-2]for e,m,r in((r,e,m),(e,r,d)))for e,d in e(zip(*z))]for r,m in e(z)]