p=lambda g:[*zip(*[[x and(w==min(s:=[*filter(any,zip(*g))]))*2+(w==max(s))for x in w]for w in zip(*g)])]