def p(m):o=sum(m,[]);e=10;n=max(k:={*o}-{0},key=o.count);r=[f for f in range(e*e)if o[f]==n];p=min(f:={f%e for f in r});_=len(f);r,f=r[0]//e,r[-1]//e;r-=f-r<2 and 0 in m[r][p:p+_];p-=3-_ and 0 in o[r*e+p:f*e+p+1:e];return[[f or sum(k)-n for f in f[p:p+3]]for f in (m+[[0]*e])[r:r+3]]