def p(n):_=sum(n,[]);r=10;m=max(k:={*_}-{0},key=_.count);e=[f for f in range(r*r)if _[f]==m];o=min(f:={f%r for f in e});p=len(f);e,f=e[0]//r,e[-1]//r;e-=f-e<2 and 0 in n[e][o:o+p];o-=3-p and 0 in _[e*r+o:f*r+o+1:r];return[[f or sum(k)-m for f in f[o:o+3]]for f in (n+[[0]*r])[e:e+3]]