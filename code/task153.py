def p(f):d=sum(f,[]);u=10;t=max(j:={*d}-{0},key=d.count);n=[c for c in range(u*u)if d[c]==t];e=min(c:={c%u for c in n});r=len(c);n,v=n[0]//u,n[-1]//u;n-=v-n<2 and 0 in f[n][e:e+r];e-=3-r and 0 in d[n*u+e:v*u+e+1:u];return[[c or sum(j)-t for c in c[e:e+3]]for c in (f+[[0]*u])[n:n+3]]