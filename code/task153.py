def p(u):s=sum(u,[]);n={*s}-{0};p=max(n,key=s.count);f=[[s for*u,s in zip(*u,f)if p in u]for f in u if p in f];z=[[0]*3]*(len(f)<3);e=[0]*(len(f[0])<3);a=0 in f[0];r=0 in[*zip(*f)][0];return eval(str([e*r+f+e*(1-r)for f in z*a+f+z*(1-a)]).replace(*f"0{sum(n)-p}"))