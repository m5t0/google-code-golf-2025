def p(e):d=min(l:=sum(e,[]),key=l.count);return max(([[n and d for n in n[r:s+1]]for n in e[n:a+1]]for n,w in enumerate(e)for r,w in enumerate(e[0])for a,w in enumerate(e)for s,w in enumerate(e[0])if{sum({*l})-d}=={*e[n][r:s+1],*[*zip(*e)][r][n:a+1]}),key=lambda e:len(sum(e,[])))