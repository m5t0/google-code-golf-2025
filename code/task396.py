def p(r,f=enumerate):e=min(l:=sum(r,[]),key=l.count);r=max(([n[t:i+1]for n in r[n:m+1]]for n,k in f(r)for t,k in f(r[0])for m,k in f(r)for i,k in f(r[0])if{sum({*l})-e}=={*r[n][t:i+1],*[*zip(*r)][t][n:m+1]}),key=lambda r:len(sum(r,[])));return[[n and e for n in n]for n in r]