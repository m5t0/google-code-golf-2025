def p(n,m=enumerate):r=min(l:=sum(n,[]),key=l.count);return max(([[i and r for i in i[d:t+1]]for i in n[i:o+1]]for i,e in m(n)for d,e in m(n[0])for o,e in m(n)for t,e in m(n[0])if{sum({*l})-r}=={*n[i][d:t+1],*[*zip(*n)][d][i:o+1]}),key=lambda n:len(sum(n,[])))