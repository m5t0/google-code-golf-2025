def p(o,m=enumerate):u=min(l:=sum(o,[]),key=l.count);d=max(([e[p:r+1]for e in o[e:a+1]]for e,t in m(o)for p,t in m(o[0])for a,t in m(o)for r,t in m(o[0])if{sum({*l})-u}=={*o[e][p:r+1],*[*zip(*o)][p][e:a+1]}),key=lambda o:len(sum(o,[])));return[[e and u for e in e]for e in d]