def p(e):n=len(g:=[[m[0]for m in zip(i,*e)if 8in m]for i in e if 8in i])+1;m=range(n+1);i=sum(e,[]);p,x=divmod([i.index(n)for n in i if n%8][0]-1,len(e[0]));p=[[max(e[i+p][d+x],0<i<n>d>0and g[i-1][d-1])for d in m]for i in m];x=lambda i,d:i-i*(i<min(d,n-d,n-i))+(n-i)*(n-i<min(d,n-d,i));return[[(p[i][d]>0)*p[x(i,d)][x(d,i)]for d in m]for i in m]