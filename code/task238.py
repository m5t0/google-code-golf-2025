def p(z):f=len(a:=[[z[0]for z in zip(i,*z)if 8in z]for i in z if 8in i])+1;p=range(f+1);i=sum(z,[]);m,x=divmod([i.index(a)for a in i if a%8][0]-1,len(z[0]));x=[[max(z[i+m][d+x],0<i<f>d>0and a[i-1][d-1])for d in p]for i in p];e=lambda i,d:i-i*(i<min(d,f-d,f-i))+(f-i)*(f-i<min(d,f-d,i));return[[(x[i][d]>0)*x[e(i,d)][e(d,i)]for d in p]for i in p]