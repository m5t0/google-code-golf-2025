def p(e):o=len(b:=[[m[0]for m in zip(i,*e)if 8in m]for i in e if 8in i])+1;m=range(o+1);i=sum(e,[]);p,z=divmod([i.index(o)for o in i if o%8][0]-1,len(e[0]));g=[[max(e[i+p][d+z],0<i<o>d>0and b[i-1][d-1])for d in m]for i in m];z=lambda i,d:i-i*(i<min(d,o-d,o-i))+(o-i)*(o-i<min(d,o-d,i));return[[(g[i][d]>0)*g[z(i,d)][z(d,i)]for d in m]for i in m]