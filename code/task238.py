def p(a):m=len(p:=[[e[0]for e in zip(n,*a)if 8in e]for n in a if 8in n])+1;e=range(m+1);n=sum(a,[]);i,d=divmod([n.index(m)for m in n if m%8][0]-1,len(a[0]));i=[[max(a[n+i][e+d],0<n<m>e>0and p[n-1][e-1])for e in e]for n in e];d=lambda n,e:n-n*(n<min(e,m-e,m-n))+(m-n)*(m-n<min(e,m-e,n));return[[(i[n][e]>0)*i[d(n,e)][d(e,n)]for e in e]for n in e]