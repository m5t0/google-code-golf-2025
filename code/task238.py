def p(f):n=len(u:=[[m[0]for m in zip(i,*f)if 8in m]for i in f if 8in i])+1;m=range(n+1);i=sum(f,[]);r,x=divmod([i.index(n)for n in i if n%8][0]-1,len(f[0]));r=[[max(f[i+r][d+x],0<i<n>d>0and u[i-1][d-1])for d in m]for i in m];x=lambda i,d:i-i*(i<min(d,n-d,n-i))+(n-i)*(n-i<min(d,n-d,i));return[[(r[i][d]>0)*r[x(i,d)][x(d,i)]for d in m]for i in m]