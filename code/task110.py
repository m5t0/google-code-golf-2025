p=lambda g,r=range(29):[[max(g,key=lambda V:sum(v[k]==V[k]for k in r if V[j]))[j]for j in r]for v in g]