f=lambda g:[0in r and min(g,key=lambda s:(0in s,sum(x&~y for x,y in zip(r,s))))or r for r in g]
p=lambda g:g[0][1]and f(g)or f([*zip(*g)])