def p(b):o=max(b[0],key=b[0].count);f,=[f for a in(b,b[::-1])for d in range(len(b)-2)for e in range(len(b[0])-2)if len(set(f:=[a[d+p//3][e+p%3]for p in range(9)]))>3>0<o!=f[0]!=f[8]];[(n:=lambda o=o,b=o,c=o,*z:[o]*u+[b]*u+[c]*u)(n(f[0]),n(),n(c=f[8]))!=[a[d+p][e:[e+3*u*c,None][e+3*u*c<0]:c]for p in range(3*u)]or exec('for p in range(3*u):a[d+p][e:[e+3*u*c,None][e+3*u*c<0]:c]=n(*f[p//u*3:])')for u in range(4)for c in(1,-1)for d in range(len(b)-3*u+1)for e in range(len(b[0]))for a in(b,b[::-1])];return b