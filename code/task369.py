def p(g,e=enumerate):d=0,1,0,-1;f=lambda g,n,P:1+sum(f(g,(I,J),n)for i in range(4)if-1<(I:=n[0]+d[i])<10>(J:=n[1]+d[i-3])>=0and g[I][J]==0!=(I,J)!=P);return[[w or 4-f(g,(i,j),(i,j))for j,w in e(v)]for i,v in e(g)]