p=lambda g:exec("g[:]=[*zip(*[[v[j]or(c:=min(v,key=v.count))*(len({*v})>2>v[j:].count(c)==1>sum(v[v.index(c)+1:]))for j in range(len(v))]for v in g])][::-1];"*4)or g