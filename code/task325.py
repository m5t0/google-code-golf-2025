p=lambda g,k=27,l=1:-k*(0<(s:=len({*sum(g,[])})-1))*[[0]*e+[8]+[0]*(s-e-1)for e in range(s)]or p([(b:=0)or[(a>0)*[[b|(b:=a),l:=l*2][(a|((a>0)&k//27))&1],a][k<1]for a in r]for r in zip(*g[::-1])],k-1)