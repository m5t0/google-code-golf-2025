def p(n):s=sum(n,[]);h=max({*s}-{0},key=s.count);s=f"[s for s in zip(*%s)if s.count({h})>2]";c=len(s:=eval(s%s%"n"))//len(i:=[[*filter(int,i)][-4:]for i,s in zip(n,n[1:])if{*i,*s}-{h,0}][1:]);return[[i/h*s for i,s in zip(i,s[::c])]for i,s in zip(i,s[::c])]