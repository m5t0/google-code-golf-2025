p=lambda g,k=150:-k*(g:=[*zip(*g)][::-1])or p([[[(a>3)+(a>5)+(a==5)*5,(a>0)*max(a,b),(c==b==a>0)+a][k%37//36+(k>0)]for a,b,c in zip(x,(0,)+x,y)]for x,y in zip(g,[[0]*37]+g)],k-1)