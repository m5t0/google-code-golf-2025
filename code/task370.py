def p(o,a=range):h=lambda b,f:[k for k in a(c)if m>f+k*i>-1<b+k*w<c>o[b+k*w][f+k*i]<1];b=(q:=sum(o,[])).index(0);m=len(o[0]);c=len(o);g=q.index(v:=min(q,key=q.count));w,i=1-2*(g>b),1-2*(g%m>b%m);n=max(n:=h(g//m,g%m))-n[0]+1;w*=n;i*=n;return[[o[i][m]and[v,o[i][m]][h(i,m)==[]]for m in a(m)]for i in a(c)]