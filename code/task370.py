def p(y,h=range):u=lambda m,e:[u for u in h(n)if r>e+u*w>-1<m+u*_<n>y[m+u*_][e+u*w]<1];m=(e:=sum(y,[])).index(0);r=len(y[0]);n=len(y);e=e.index(o:=min(e,key=e.count));_,w=1-2*(e>m),1-2*(e%r>m%r);m=max(e:=u(e//r,e%r))-e[0]+1;_*=m;w*=m;return[[y[n][e]and[o,y[n][e]][u(n,e)==[]]for e in h(r)]for n in h(n)]