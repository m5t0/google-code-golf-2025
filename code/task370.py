def p(m,t=range):a=lambda i,l:[a for a in t(n)if p>l+a*r>-1<i+a*w<n>m[i+a*w][l+a*r]<1];i=(l:=sum(m,[])).index(0);p=len(m[0]);n=len(m);l=l.index(u:=min(l,key=l.count));w,r=1-2*(l>i),1-2*(l%p>i%p);i=max(l:=a(l//p,l%p))-l[0]+1;w*=i;r*=i;return[[m[n][l]and[u,m[n][l]][a(n,l)==[]]for l in t(p)]for n in t(n)]