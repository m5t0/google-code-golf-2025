def p(o,x=range):e=lambda y,f:[k for k in x(n)if t>f+k*i>-1<y+k*A<n>o[y+k*A][f+k*i]<1];y=(a:=sum(o,[])).index(0);t=len(o[0]);n=len(o);g=a.index(c:=min(a,key=a.count));A,i=1-2*(g>y),1-2*(g%t>y%t);s=max(s:=e(g//t,g%t))-s[0]+1;A*=s;i*=s;return[[o[i][t]and[c,o[i][t]][e(i,t)==[]]for t in x(t)]for i in x(n)]