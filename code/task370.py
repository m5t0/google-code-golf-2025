def p(g,m=range):k=lambda o,d:[k for k in m(n)if p>d+k*r>-1<o+k*c<n>g[o+k*c][d+k*r]<1];o=(d:=sum(g,[])).index(0);p=len(g[0]);n=len(g);d=d.index(u:=min(d,key=d.count));c,r=1-2*(d>o),1-2*(d%p>o%p);o=max(d:=k(d//p,d%p))-d[0]+1;c*=o;r*=o;return[[g[n][d]and[u,g[n][d]][k(n,d)==[]]for d in m(p)]for n in m(n)]