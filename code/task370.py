def p(_,t=range):f=lambda e,n:[f for f in t(a)if d>n+f*r>-1<e+f*x<a>_[e+f*x][n+f*r]<1];e=(n:=sum(_,[])).index(0);d=len(_[0]);a=len(_);n=n.index(p:=min(n,key=n.count));x,r=1-2*(n>e),1-2*(n%d>e%d);e=max(n:=f(n//d,n%d))-n[0]+1;x*=e;r*=e;return[[_[a][n]and[p,_[a][n]][f(a,n)==[]]for n in t(d)]for a in t(a)]