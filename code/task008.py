p=lambda g:[g:=[*zip(*(len(g)-len(u:=[v for i,v in enumerate(g)if m(v)or m(m(g[i:]))<8]))*[min(g)]+u)][::-1]for m in[max]*4][3]