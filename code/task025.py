def p(f):
 u=len;*e,=zip(*f);f=[e,f][r:=1in{u({*p})for p in e}];n=u(f[0]);e=[n*[0]for p in f]
 for p in range(u(f)*n):
  if(p:=(x:=f[i:=p//n])[t:=p%n])*(u({*[*zip(*f)][t]})<2):
   i=e[i];i[t]=p;i[t-1]=p*(p in x[:t])
   if t<n-1:i[t+1]=p*(p in x[t+1:])
 return([*zip(*e)],e)[r]