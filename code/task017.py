p=lambda r:(z:=range(21),l:=min(n for n in z[2:]if all((n-a)*n*a<1for n,a in zip(r[0],r[0][n:]))),r:={(n%l,a%l):i for n in z for a in z if(i:=r[n][a])})and[[r[n%l,a%l]for a in z]for n in z]