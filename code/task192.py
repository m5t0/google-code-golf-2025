p=lambda g,e=enumerate:[[[w[i],len(a:={*v[j-(j>0):j+2]}&{*w[i-(i>0):i+2]}-{0,c:=min(V:=sum(g,[]),key=V.count)})*sum(a)][c==w[i]]for j,w in e(zip(*g))]for i,v in e(g)]