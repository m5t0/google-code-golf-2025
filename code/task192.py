p=lambda g,k=3:-k*g or p([[[b*(b in a or k>2),max(a)][sum(g,[]).count(b)<30]for*a,b in zip((0,)+v,v[1:]+(0,),v)]for v in zip(*g)],k-1)