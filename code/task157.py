def p(m):n,p,*r=range,15;i=sum(m,[]);m=[[]];[(m:=[m+[(f,r)]for m in m for f in n(45)if i[f]<1],r:=[])for f in n(16)if r==(r:=r+[n for n in n(f,150,p)if(p>f)&i[n]])>[]];return max([*zip(*[((any(n-f+min(m)in m*(f%p-n%p<6)for f,m in m)|i[n]%5)%3for n in n(150))]*p)]for m in m)