def p(g,r=range):m=len(g);s=r(m);t=[max(max(i*(v[i]==x)for i in s)for v in zip(*g))for x in s];return[[(g*3)[m+i+t[max([*zip(*g)][j])]-t[1]][j]for j in r(len(g[0]))]for i in s]