e=lambda a,i:[*a[i:],2].index(2)+[*a[i::-1],2].index(2)-1
p=lambda z,t=enumerate:[[n[r]or((o:=sorted({e(a,i)*e(n,r)for i,n in t(zip(*z))for r,a in t(z)if n[r]<1}))[-1]==(d:=e(a,i)*e(n,r)))+(o[0]==d)*8for i,n in t(zip(*z))]for r,a in t(z)]