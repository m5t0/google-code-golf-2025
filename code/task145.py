d=lambda s,i:[*s[i:],2].index(2)+[*s[i::-1],2].index(2)-1
p=lambda g,a=enumerate:[[r[t]or((o:=sorted({d(s,i)*d(r,t)for i,r in a(zip(*g))for t,s in a(g)if r[t]<1}))[-1]==(q:=d(s,i)*d(r,t)))+(o[0]==q)*8for i,r in a(zip(*g))]for t,s in a(g)]