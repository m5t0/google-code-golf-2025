p=lambda g,r=range(30):min([(len(t)-(1in t[0])*2,t)for c in r if(t:=[[v[j]for j in r if c in[*zip(*g)][j]]for v in g if c in v])])[1]