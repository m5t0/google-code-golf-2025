p=lambda g,t=0:[[(t:=[x+2*(0<x<t<9),3+5*(x>7)+9*(t>2)][8in{*w}&{*v}])%9for*w,x in zip(*g,v)]for v in g]