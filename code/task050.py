f=lambda g:[[w or(8in{*v[:j]}&{*v[j:]})*3for j,w in enumerate(v)]for v in zip(*g)]
p=lambda g:f(f(g))