def p(l,o=enumerate):m=lambda l:[i for i,k in o(l)if all(k)];f,b=m(l);c,p=m(zip(*l));m=lambda p,m,i,a:max(max(c)*(max(c)==b)for c,b in((a[p+1:i+1],a[m]),(a[i:m],a[p])));return[[k[c+e]or max(m(f,b,f+i,a),m(c,p,c+e,k))for e,a in o([*zip(*l)][c:p+1])]for i,k in o(l[f:b+1])]