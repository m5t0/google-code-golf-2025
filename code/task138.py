def p(m,e=enumerate):f=lambda m:[i for i,r in e(m)if all(r)];l,t=f(m);p,g=f(zip(*m));a=lambda t,l,i,m:max(max(a)*(max(a)==t)for a,t in((m[t+1:i+1],m[l]),(m[i:l],m[t])));return[[r[p+f]or max(a(l,t,l+i,m),a(p,g,p+f,r))for f,m in e([*zip(*m)][p:g+1])]for i,r in e(m[l:t+1])]