p=lambda d,j=range(16):[[[i[(f,2*e-f+h)[i[f]==a]]for f in j]for i in d]for a in j if len({i[f]for i in d for f in j if a in i if a in[*zip(*d)][f]})<2for h in(0,1)for e in j if all((i[f]!=a!=i[t]!=i[f])^1if(t:=2*e-f+h)in j else i[f]in(0,a)for i in d for f in j)][0]