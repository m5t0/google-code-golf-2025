def p(g,r=range):f=lambda x:min(i for i in r(19)if all(x[i:i+3]));s,t=f([*map(any,g)]),f([*map(any,zip(*g))]);h=lambda o,x,y:min(20,max(0,o+4*((x>0)-(x<0))+y));return[[(0,max(g[h(s,x:=(i-s)//4,k//3)][h(t,y:=(j-t)//4,k%3)]for k in r(9))*(g[s+(i-s)%4][t+(j-t)%4]>0))[abs(x)==abs(y)or x*y==0]for j in r(21)]for i in r(21)]