def p(e,f=range(21)):r=lambda a:min(n for n in f if min(a[n:n+3]));d=r([*map(p:=max,e)]);r=r([*map(p,*e)]);i=lambda a:4*((a>0)-(a<0));return[[p(e[d+i(a:=(n-d)//4)+f//3][r+i(u:=(o-r)//4)+f%3]for f in f[:9])*(e[d+(n-d)%4][r+(o-r)%4]>=(a*a==u*u)|(a*u==0)>0)for o in f]for n in f]