def p(f,e=enumerate):l=len({*f[4]})+1;b=range(l*5);r=[[f[i//l][t//l]for t in b]for i in b];b=r[:-l];x=lambda z=min,b=[*zip(*r)][:-l]:z(i for i,d in e(b)if any(d[:-l]));m=x(b=b),x(max,b);b=x(),x(max);return[[l or any((i-z)*(2*x-1)==(t-l)*(2*y-1)for x,z in e(m)for y,l in e(b))*2for t,l in e(d)]for i,d in e(r)]