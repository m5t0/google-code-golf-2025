def p(p,e=enumerate):l=len({*p[4]})+1;t=range(l*5);r=[[p[x//l][t//l]for t in t]for x in t];t=r[:-l];p=lambda p=min,t=[*zip(*r)][:-l]:p(x for x,r in e(t)if any(r[:-l]));a=p(t=t),p(max,t);i=p(),p(max);return[[l or any((x-p)*(2*a-1)==(t-l)*(2*d-1)for a,p in e(a)for d,l in e(i))*2for t,l in e(r)]for x,r in e(r)]