p=lambda g,e=enumerate:[[w*(w==2)or(w>7)*4or((2in o[m:])*(8in o[:m])or(8in o[m:])*(2in o[:m]))*8or(a-abs((y:=[*zip(*g)])[0].index(2)-y[-1].index(2))in[m for m,e in e(g)if 8in e])*8for m,w in e(o)]for a,o in e(g)]